language: objective-c

osx_image: xcode9.4
script:
SWIFTLINT_PKG_PATH="/tmp/SwiftLint.pkg"
SWIFTLINT_PKG_URL="https://github.com/realm/SwiftLint/releases/download/0.9.1/SwiftLint.pkg"

wget --output-document=$SWIFTLINT_PKG_PATH $SWIFTLINT_PKG_URL  && sudo installer -pkg $SWIFTLINT_PKG_PATH -target /

- xcrun  instruments -w "iPhone 7 (11.4) [3783E9FF-F5A4-4132-91DD-261AC70C67A0] (Simulator)" || true
# enabled later: asset 1024x1024 for appstore is missing:GCC_TREAT_WARNINGS_AS_ERRORS=YES
- xcodebuild -workspace tflapp.xcworkspace -scheme tflapp -destination 'platform=iOS Simulator,name=iPhone 7' -sdk iphonesimulator build CODE_SIGNING_REQUIRED=NO  ONLY_ACTIVE_ARCH=NO  RUN_CLANG_STATIC_ANALYZER=YES 
- xcodebuild -workspace tflapp.xcworkspace -scheme tflapp -destination 'platform=iOS Simulator,name=iPhone 7' -sdk iphonesimulator build CODE_SIGNING_REQUIRED=NO  ONLY_ACTIVE_ARCH=NO  test
- travis_retry xcodebuild -workspace tflapp.xcworkspace -scheme tflapp -destination 'platform=iOS Simulator,name=iPhone 7' -sdk iphonesimulator clean test CODE_SIGNING_REQUIRED=NO  ONLY_ACTIVE_ARCH=NO 
- bash <(curl -s https://codecov.io/bash)

notifications:
  slack: 'samedialabs:$SLACK_SAMEDIALABS_TRAVIS_CI'

